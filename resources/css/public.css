@import 'tailwindcss';
@import 'highlight.js/styles/atom-one-light.css';

@plugin "tailwindcss-motion";

@custom-variant dark (&:is(.dark *));
@custom-variant light (&:is(.light *));

@theme {
    --color-gray-990: rgb(19, 20, 21);
    --color-gray-975: rgb(39, 41, 43);
    --color-gray-950: rgb(49, 51, 54);
    --color-gray-900: rgb(68, 72, 75);
    --color-gray-800: rgb(87, 92, 96);
    --color-gray-700: rgb(107, 113, 117);
    --color-gray-600: rgb(121, 128, 134);
    --color-gray-500: rgb(148, 153, 157);
    --color-gray-400: rgb(169, 174, 177);
    --color-gray-300: rgb(192, 194, 197);
    --color-gray-200: rgb(223, 225, 226);
    --color-gray-100: rgb(244, 245, 245);
    --color-gray-0: rgb(255, 255, 255);

    --color-design-system-border: var(--color-gray-300);
    --color-design-system-primary: var(--color-atomic-tangerine-400);
    --color-design-system-title: var(--color-gray-990);
    --color-design-system-paragraph: var(--color-gray-800);
    --design-system-border-width: 0.0625rem;
    --color-design-system-border-radius: 0.5rem;
    --color-atomic-tangerine-50: rgb(254, 242, 236);
    --color-atomic-tangerine-100: rgb(252, 216, 198);
    --color-atomic-tangerine-200: rgb(250, 190, 158);
    --color-atomic-tangerine-300: rgb(249, 177, 138);
    --color-atomic-tangerine-400: rgb(247, 142, 87);
    --color-atomic-tangerine-500: rgb(246, 124, 61);
    --color-atomic-tangerine-600: rgb(244, 99, 22);
    --color-atomic-tangerine-700: rgb(215, 82, 9);
    --color-atomic-tangerine-800: rgb(175, 67, 8);
    --color-atomic-tangerine-900: rgb(135, 52, 7);
    --color-atomic-tangerine-950: rgb(117, 43, 5);
    --color-atomic-tangerine-990: rgb(77, 29, 3);

    --color-action-container-inter-border-radius: var(--color-design-system-border-radius);
    --color-action-container-outer-border-radius: 1rem;
    --color-action-container-outer-color: rgba(244, 245, 245, 0.5);
    --action-container-shadow-x: 0;
    --action-container-shadow-y: 0.5rem;
    --action-container-shadow-blur: 1rem;
    --color-action-container-inter-padding: var(--color-action-container-inter-border-radius);
    --color-action-container-shadow-color: rgba(0, 0, 0, 0.2);
    --action-container-background-blur: 0.0625rem;

    --breakpoint-xs: 25rem;
}

@theme inline {
    --font-sans: 'Inter', sans-serif;
    --color-border: var(--design-system-border);
    --color-black: var(--gray-990);
    --color-primary: var(--design-system-primary);
    --color-background: var(--design-system-background);
    --color-foreground: var(--design-system-foreground);
}

@layer base {
    * {
        @apply border-border;
    }

    body {
        @apply bg-background text-foreground transition-colors duration-300;
    }
}

@utility action-container-shadow {
    box-shadow: var(--action-container-shadow-x) var(--action-container-shadow-y) var(--action-container-shadow-blur) 0
        var(--color-action-container-shadow-color);
}

@utility action-container-background-blur {
    @apply backdrop-blur-[var(--action-container-background-blur)];
}

@utility action-container-outer-border {
    border: var(--design-system-border-width) solid var(--color-gray-200);
    @apply dark:border-gray-700;
}

@utility action-container-outer-shadow {
    box-shadow: 0 0.0625rem 0.125rem 0 rgba(0, 0, 0, 0.06);
    @apply dark:shadow-[0_0.0625rem_0.125rem_0_rgba(0,0,0,0.3)];
}

@utility action-container-inner-shadow {
    box-shadow:
        0 0 0 0.5rem rgba(255, 255, 255, 0.3),
        0 4rem 1.5rem 0 rgba(0, 0, 0, 0),
        0 2.75rem 1.375rem 0 rgba(0, 0, 0, 0.02),
        0 1.75rem 1.25rem 0 rgba(0, 0, 0, 0.08),
        0 1rem 1rem 0 rgba(0, 0, 0, 0.13),
        0 0.625rem 0.75rem 0 rgba(0, 0, 0, 0.15);
    @apply dark:[box-shadow:0_0_0_0.5rem_rgba(0,0,0,0.2),0_4rem_1.5rem_0_rgba(0,0,0,0),0_2.75rem_1.375rem_0_rgba(0,0,0,0.05),0_1.75rem_1.25rem_0_rgba(0,0,0,0.15),0_1rem_1rem_0_rgba(0,0,0,0.25),0_0.625rem_0.75rem_0_rgba(0,0,0,0.3)];
}

/* Light theme variables (default) */
:root {
    /* Grays for light theme */
    --gray-0: rgb(255, 255, 255);
    --gray-100: rgb(244, 245, 245);
    --gray-200: rgb(223, 225, 226);
    --gray-300: rgb(192, 194, 197);
    --gray-400: rgb(169, 174, 177);
    --gray-500: rgb(148, 153, 157);
    --gray-600: rgb(121, 128, 134);
    --gray-700: rgb(107, 113, 117);
    --gray-800: rgb(87, 92, 96);
    --gray-900: rgb(68, 72, 75);
    --gray-950: rgb(49, 51, 54);
    --gray-975: rgb(39, 41, 43);
    --gray-990: rgb(19, 20, 21);

    /* Atomic tangerine for light theme */
    --atomic-tangerine-50: rgb(254, 242, 236);
    --atomic-tangerine-100: rgb(252, 216, 198);
    --atomic-tangerine-200: rgb(250, 190, 158);
    --atomic-tangerine-300: rgb(249, 177, 138);
    --atomic-tangerine-400: rgb(247, 142, 87);
    --atomic-tangerine-500: rgb(246, 124, 61);
    --atomic-tangerine-600: rgb(244, 99, 22);
    --atomic-tangerine-700: rgb(215, 82, 9);
    --atomic-tangerine-800: rgb(175, 67, 8);
    --atomic-tangerine-900: rgb(135, 52, 7);
    --atomic-tangerine-950: rgb(117, 43, 5);
    --atomic-tangerine-990: rgb(77, 29, 3);

    /* Design system colors for light theme */
    --design-system-background: var(--gray-100);
    --design-system-foreground: var(--gray-990);
    --design-system-border: var(--gray-300);
    --design-system-primary: var(--atomic-tangerine-400);
    --design-system-title: var(--gray-990);
    --design-system-paragraph: var(--gray-800);

    /* Action container colors for light theme */
    --action-container-outer-color: rgba(244, 245, 245, 0.5);
    --action-container-shadow-color: rgba(0, 0, 0, 0.2);
    --action-container-border: var(--gray-200);

    /* SVG dot matrix background */
    --dot-matrix-color: rgba(192, 194, 197, 0.3);
}

/* Dark theme variables */
.dark {
    /* Design system colors for dark theme */
    --design-system-background: var(--gray-950);
    --design-system-foreground: var(--gray-100);
    --design-system-border: var(--gray-700);
    --design-system-primary: var(--atomic-tangerine-400);
    --design-system-title: var(--gray-100);
    --design-system-paragraph: var(--gray-300);

    /* Action container colors for dark theme */
    --action-container-outer-color: rgba(31, 41, 55, 0.5); /* gray-800 with opacity */
    --action-container-shadow-color: rgba(0, 0, 0, 0.5);
    --action-container-border: var(--gray-700);

    /* SVG dot matrix background */
    --dot-matrix-color: rgba(107, 113, 117, 0.3);

    /* Override highlight.js theme to Atom One Dark in dark mode */

    & .hljs {
        background: #282c34;
        color: #abb2bf;
    }

    & .hljs-comment,
    & .hljs-quote {
        @apply text-gray-500;
        font-style: italic;
    }

    & .hljs-doctag,
    & .hljs-keyword,
    & .hljs-formula {
        color: #c678dd;
    }

    & .hljs-section,
    & .hljs-name,
    & .hljs-selector-tag,
    & .hljs-deletion,
    & .hljs-subst {
        color: #e06c75;
    }

    & .hljs-literal {
        color: #56b6c2;
    }

    & .hljs-string,
    & .hljs-regexp,
    & .hljs-addition,
    & .hljs-attribute,
    & .hljs-meta .hljs-string {
        color: #98c379;
    }

    & .hljs-attr,
    & .hljs-variable,
    & .hljs-template-variable,
    & .hljs-type,
    & .hljs-selector-class,
    & .hljs-selector-attr,
    & .hljs-selector-pseudo,
    & .hljs-number {
        color: #d19a66;
    }

    & .hljs-symbol,
    & .hljs-bullet,
    & .hljs-link,
    & .hljs-meta,
    & .hljs-selector-id,
    & .hljs-title {
        color: #61aeee;
    }

    & .hljs-built_in,
    & .hljs-title.class_,
    & .hljs-class .hljs-title {
        color: #e6c07b;
    }

    & .hljs-emphasis {
        font-style: italic;
    }

    & .hljs-strong {
        font-weight: bold;
    }

    & .hljs-link {
        text-decoration: underline;
    }

    /* Dark mode markdown elements */

    & .markdown-view {
        & pre {
            @apply border-gray-600 bg-gray-950;
        }

        & code:not(pre code) {
            @apply bg-gray-700 text-gray-200;
        }

        & blockquote {
            @apply border-gray-600 text-gray-400;
        }

        & th,
        & td {
            @apply border-gray-600;
        }

        & th {
            @apply bg-gray-800;
        }

        & hr {
            @apply border-gray-600;
        }

        & pre::-webkit-scrollbar-track {
            @apply bg-gray-800;
        }

        & pre::-webkit-scrollbar-thumb {
            @apply bg-gray-600;
        }

        & pre::-webkit-scrollbar-thumb:hover {
            @apply bg-gray-500;
        }
    }
}

/* Ensure smooth transitions for theme changes */
body,
body * {
    transition:
        background-color 0.3s ease,
        color 0.3s ease,
        border-color 0.3s ease,
        box-shadow 0.3s ease,
        fill 0.3s ease;
}

/* Prevent transition on page load */
.no-transition,
.no-transition * {
    transition: none !important;
}

/* Utility classes for design system text colors with dark mode support */
@utility text-design-system-title {
    @apply text-gray-990 dark:text-gray-100;
}

@utility text-design-system-paragraph {
    @apply text-gray-800 dark:text-gray-200;
}

@utility markdown-view {
    @apply text-gray-800 dark:text-gray-300;

    /* Headings */
    & h1,
    & h2 {
        @apply text-gray-990 mb-6 text-2xl font-bold dark:text-gray-100;
    }

    & h3 {
        @apply text-gray-990 mb-4 text-xl font-bold dark:text-gray-100;
    }

    & h4 {
        @apply text-gray-990 relative mb-3 ml-6 text-lg font-bold dark:text-gray-200;

        /* Tangerine bullet point */

        &::before {
            content: '';
            @apply bg-atomic-tangerine-400 absolute top-1/2 -left-5 h-2 w-2 -translate-y-1/2 rounded-full;
        }
    }

    & h5 {
        @apply text-gray-990 relative mb-2 ml-4 inline-block text-base font-semibold dark:text-gray-200;

        /* Tangerine underline */

        &::after {
            content: '';
            @apply bg-atomic-tangerine-400 absolute bottom-0 left-0 h-[0.1825rem] w-full;
        }
    }

    & h1:not(:first-child),
    & h2:not(:first-child) {
        @apply mt-8;
    }

    & h3:not(:first-child),
    & h4:not(:first-child),
    & h5:not(:first-child) {
        @apply mt-6;
    }

    /* Reduced spacing when h4 directly follows h3 */
    & h3 + h4 {
        @apply mt-2!;
    }

    /* Reduced spacing when h5 directly follows h4 */
    & h4 + h5 {
        @apply mt-2!;
    }

    /* Links */
    & a {
        color: var(--color-design-system-primary);
        @apply underline;
    }

    /* Paragraphs */
    & p:not(:last-child) {
        @apply mb-4;
    }

    /* Reduced spacing when paragraph in li is followed by ul */
    & li p:has(+ ul) {
        @apply mb-1!;
    }

    /* Lists */
    & ul {
        @apply mb-4 list-outside list-disc pt-2 pl-8;
    }

    & ul li {
        @apply mb-2;
    }

    & ol {
        @apply mb-4 list-outside list-decimal pt-2 pl-8;
    }

    & ol li {
        @apply mb-2;
    }

    /* Blockquotes */
    & blockquote {
        @apply my-4 border-l-4 border-gray-300 pl-4 text-gray-600 italic;
    }

    /* Tables */
    & table {
        @apply my-4 w-full border-collapse;
    }

    & th,
    & td {
        @apply border border-gray-300 px-4 py-2;
    }

    & th {
        @apply bg-gray-100 font-semibold;
    }

    /* Horizontal rules */
    & hr {
        @apply my-8 border-t border-none border-gray-300;
    }

    /* Images */
    & img {
        @apply my-4 h-auto max-w-full rounded-lg;
    }

    /* Code blocks */
    & pre {
        @apply relative my-4 max-w-full overflow-x-auto rounded-lg border border-gray-200 bg-gray-50;
    }

    & pre code {
        @apply block bg-transparent p-4 font-mono text-sm;
    }

    /* Ensure hljs code blocks are visible */
    & pre.hljs {
        @apply p-0;
    }

    & pre.hljs code {
        @apply bg-transparent;
    }

    /* Inline code */
    & code:not(pre code) {
        @apply rounded bg-gray-200 px-1.5 py-0.5 font-mono text-sm text-gray-900;
    }

    /* Scrollbar styling for code blocks */
    & pre::-webkit-scrollbar {
        @apply h-2;
    }

    & pre::-webkit-scrollbar-track {
        @apply rounded bg-gray-100;
    }

    & pre::-webkit-scrollbar-thumb {
        @apply rounded bg-gray-400;
    }

    & pre::-webkit-scrollbar-thumb:hover {
        @apply bg-gray-500;
    }
}
